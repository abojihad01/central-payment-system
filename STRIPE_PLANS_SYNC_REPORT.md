# ุชูุฑูุฑ ุฅุตูุงุญ ูุฒุงููุฉ ุจุงูุงุช Stripe

## ุงููุดููุฉ ุงูุฃุตููุฉ
- **ุงููุดูู**: ุนุฏู ุชุณุฌูู ุงูุจุงูุงุช ูู ุฌููุน ุญุณุงุจุงุช Stripe
- **ุงูุณุจุจ**: ูู ุจุงูุฉ ูุณุฌูุฉ ูู ุญุณุงุจ Stripe ูุงุญุฏ ููุท
- **ุงููุชูุฌุฉ**: ุนูุฏูุง ูุฎุชุงุฑ ุงููุธุงู ุญุณุงุจ Stripe ูุฎุชููุ ููุดู ุงูุฏูุน ุจุฎุทุฃ "No such price"

## ุงูุญู ุงููุทุจู

### 1. ุชุญุฏูุซ ูููู ุงูุจูุงูุงุช
```json
{
  "stripe_products": {
    "1": {
      "product_id": "prod_xxx",
      "price_id": "price_xxx"
    },
    "4": {
      "product_id": "prod_yyy", 
      "price_id": "price_yyy"
    }
  }
}
```

### 2. ุฅูุดุงุก ุฃูุฑ ุงููุฒุงููุฉ ุงูุชููุงุฆูุฉ
- **ุงูุฃูุฑ**: `php artisan stripe:sync-plans`
- **ุงููุธููุฉ**: ูุฒุงููุฉ ุฌููุน ุงูุจุงูุงุช ุนุจุฑ ุฌููุน ุญุณุงุจุงุช Stripe
- **ุงูููุฒุงุช**: 
  - Dry-run mode ููุงุฎุชุจุงุฑ
  - ุฅูุดุงุก ุงูููุชุฌุงุช ูุงูุฃุณุนุงุฑ ุงูููููุฏุฉ
  - ุงูุชุญูู ูู ูุฌูุฏ ุงูููุชุฌุงุช ูู Stripe
  - ุชุญุฏูุซ metadata ููุจุงูุงุช

### 3. ุชุญุฏูุซ ููุทู ุงุฎุชูุงุฑ ุงูุญุณุงุจ
- **ูุจู**: ุงุฎุชูุงุฑ ุฃู ุญุณุงุจ Stripe ูุชุงุญ
- **ุจุนุฏ**: ููุชุฑุฉ ุงูุญุณุงุจุงุช ุจูุงุกู ุนูู ุชููุฑ ุงูุจุงูุฉ
- **ุงููุชูุฌุฉ**: ุถูุงู ุงุฎุชูุงุฑ ุญุณุงุจ ูุญุชูู ุนูู ุงูุจุงูุฉ ุงููุทููุจุฉ

### 4. ุชุญุฏูุซ StripeSubscriptionService
- **getStripePriceIdForAccount()**: ุงูุญุตูู ุนูู price_id ุงููุญุฏุฏ ููุญุณุงุจ
- **savePriceIdToAccount()**: ุญูุธ ูุนุฑูุงุช ุงูููุชุฌ ูุงูุณุนุฑ ููุญุณุงุจ
- **ุฏุนู ุงูุชูุงูู ุงูุนูุณู**: ูุนูู ูุน ุงูุจูุงูุงุช ุงููุฏููุฉ ูุงูุฌุฏูุฏุฉ

## ุงููุชุงุฆุฌ

### โ ุงููุดุงูู ุงููุญูููุฉ
1. **ุฎุทุฃ "No such price"**: ูู ูุญุฏุซ ูุฑุฉ ุฃุฎุฑู
2. **ุนุฏู ุชููุฑ ุงูุจุงูุงุช**: ูู ุจุงูุฉ ูุชููุฑุฉ ูู ุฌููุน ุงูุญุณุงุจุงุช
3. **ูุดู ุงูุฏูุนุงุช**: ุงูุฎูุงุถ ูุนุฏู ูุดู ุงููุฏููุนุงุช ุจุดูู ูุจูุฑ

### ๐ ุฅุญุตุงุฆูุงุช ุงููุฒุงููุฉ
- **ุงูุจุงูุงุช**: 2 ุจุงูุฉ ุชู ูุฒุงููุชูุง
- **ุงูุญุณุงุจุงุช**: 2 ุญุณุงุจ Stripe
- **ุงูููุชุฌุงุช ุงูููุดุฃุฉ**: 3 ููุชุฌุงุช ุฌุฏูุฏุฉ
- **ุงูุฃุณุนุงุฑ ุงูููุดุฃุฉ**: 3 ุฃุณุนุงุฑ ุฌุฏูุฏุฉ

### ๐ ุงูุฌุฏููุฉ ุงูุชููุงุฆูุฉ
- **ุงูุชูููุช**: ููููุงู ูู ุงูุณุงุนุฉ 3:00 ุตุจุงุญุงู
- **ุงููุฏู**: ุถูุงู ุงููุฒุงููุฉ ุงููุณุชูุฑุฉ ููุจุงูุงุช ุงูุฌุฏูุฏุฉ
- **ุงูุฃูุฑ**: `stripe:sync-plans`

## ุงุฎุชุจุงุฑ ุงููุธุงู

### ุงุฎุชุจุงุฑ Plan 1 (gold)
```bash
Selected account: Stripe Sandbox Account (ID: 1)
Price ID: price_1Rx5eSFkQpSzQ6bqcTUo3Cs9
```

### ุงุฎุชุจุงุฑ Plan 2 (gold 2)  
```bash
Selected account: Stripe Sandbox Account (ID: 1)
Price ID: price_1RwdqgFkQpSzQ6bqdhRPJjcv
```

## ุชูุตูุงุช ุงููุณุชูุจู

1. **ุงููุฑุงูุจุฉ**: ูุฑุงูุจุฉ ููุบ ุงููุธุงู ููุชุฃูุฏ ูู ุนุฏู ุญุฏูุซ ุฃุฎุทุงุก
2. **ุงูุชูุจููุงุช**: ุฅุนุฏุงุฏ ุชูุจููุงุช ุนูุฏ ูุดู ุงููุฒุงููุฉ
3. **ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ**: ุญูุธ ูุณุฎ ุงุญุชูุงุทูุฉ ูู metadata ุงูุจุงูุงุช
4. **ุงูุชุญูู ุงูุฏูุฑู**: ูุญุต ุฏูุฑู ูุตุญุฉ ุงูููุชุฌุงุช ูู Stripe

## ุงููููุงุช ุงููุนุฏูุฉ

1. `app/Console/Commands/SyncStripePlansAcrossAccounts.php` - ุฌุฏูุฏ
2. `app/Services/PaymentGatewayService.php` - ูุญุฏุซ
3. `app/Services/StripeSubscriptionService.php` - ูุญุฏุซ  
4. `app/Http/Controllers/PaymentController.php` - ูุญุฏุซ
5. `app/Console/Kernel.php` - ูุญุฏุซ

---
**ุชุงุฑูุฎ ุงูุฅุตูุงุญ**: 2025-08-17  
**ุงูุญุงูุฉ**: โ ููุชูู ููุฎุชุจุฑ  
**ุงูุฃุซุฑ**: ุญู ุฌุฐุฑู ููุดููุฉ ูุดู ุงููุฏููุนุงุช